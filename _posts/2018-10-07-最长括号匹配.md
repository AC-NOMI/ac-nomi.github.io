---
layout:     post
title:      Leetcode 32. Longest Valid Parentheses
subtitle:   å¾ˆé«˜å…´ Swift 4 ä¸å†æ˜¯ä¸€é—¨æ–°è¯­è¨€äº†ğŸ˜…
date:       2018-10-07
author:     ACInfinity
header-img: img/post-bg-ios10.jpg
catalog: true
tags:
    - Leetcode
    - Algorithm
---
#æœ€é•¿æ‹¬å·åŒ¹é…

æ‹¬å·åŒ¹é…é—®é¢˜å¹¶ä¸é™Œç”Ÿï¼Œæ¯”è¾ƒå¸¸è§çš„æ‹¬å·åŒ¹é…é—®é¢˜æ˜¯ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²åˆ¤æ–­æ˜¯å¦æ˜¯ä¸€ä¸ªåˆæ³•çš„æ‹¬å·åºåˆ—ã€‚
æ¯”å¦‚()()ï¼Œ()(()ç­‰ã€‚

ä½†è¿™é“é¢˜æ˜¯ç»™å®šä¸€ä¸ªåªåŒ…å«()çš„ä¸²ï¼Œæ‰¾å‡ºå…¶ä¸­æœ€é•¿åˆæ³•æ‹¬å·åºåˆ—çš„é•¿åº¦ã€‚

æ¯”å¦‚()()çš„ç­”æ¡ˆæ˜¯4ï¼Œ ()(()çš„ç­”æ¡ˆæ˜¯2ï¼Œ(())()çš„ç­”æ¡ˆæ˜¯6ã€‚

æ ¹æ®ç»å…¸æ‹¬å·åŒ¹é…é—®é¢˜çš„è§£æ³•ï¼Œæ¯”è¾ƒå®¹æ˜“æƒ³åˆ°ä¸€ä¸ªO(n^2)çš„è§£æ³•ã€‚

åˆ©ç”¨ä¸€ä¸ªæ ˆSï¼Œæšä¸¾å·¦ç«¯ç‚¹Lï¼Œä¾æ¬¡è¾“å…¥å­—ç¬¦cï¼Œå½“æ»¡è¶³cä¸ºâ€˜)â€™ä¸”æ ˆé¡¶ä¸ºâ€˜(â€™çš„æ—¶å€™ï¼Œå‡ºæ ˆï¼Œå¦åˆ™å°†cå…¥æ ˆï¼›
å½“æ ˆç©ºæ—¶æ ¹æ®ä¸€åŒ¹é…å­—ç¬¦æ•°æ›´æ–°æœ€é•¿é•¿åº¦ã€‚

```java
public int longestValidParentheses(String s) {
        Stack<Character> stack = new Stack<>();
        int result = 0;
        for(int L = 0, length = s.length(); L < length; ++L) {
            while(!stack.isEmpty()) {
                stack.pop();
            }
            for (int i = L; i < length; ++i) {
                final Character ch = s.charAt(i);
                //left bracket, push into stack, wait for right bracket
                if (ch.equals('(')) {
                    stack.push(ch);
                } else {
                    if (!stack.isEmpty() && stack.peek().equals('(')) {
                        //pop top left bracket
                        stack.pop();
                    } else {
                        stack.push(ch);
                    }
                }
                //stack is empty means the sequence is valid
                if (stack.isEmpty()) {
                    result = Math.max(result, i - L + 1);
                }
            }
        }
        return result;
    }
```
è¿›ä¸€æ­¥åˆ†æä¸Šé¢çš„ä»£ç ï¼Œå…¶å®æˆ‘ä»¬åªå…³å¿ƒå®Œå…¨åŒ¹é…çš„éƒ¨åˆ†ï¼Œå¹¶ä¸å…³å¿ƒåºåˆ—å…·ä½“æ˜¯æ€ä¹ˆåŒ¹é…çš„ã€‚å¯¹äºä¸€ä¸ªå®Œå…¨åŒ¹é…çš„åºåˆ—è€Œè¨€ï¼Œå…¶æœ€å·¦å¿…æ˜¯å·¦æ‹¬å·ï¼Œæœ€å³å¿…æ˜¯å³æ‹¬å·ï¼Œå¯¹äºä¸€ä¸ªå³æ‹¬å·ï¼Œæˆ‘ä»¬åªéœ€è¦å…¶å¯¹åº”çš„å·¦æ‹¬å·çš„ä¸‹æ ‡ä¾¿å¯å¾—çŸ¥è¿™æ®µåŒ¹é…åºåˆ—çš„é•¿åº¦ã€‚
éå†æ•´ä¸ªä¸²ï¼Œç”¨ä¸€ä¸ªå˜é‡lastæ¥è®°å½•ä¸Šä¸€æ¬¡ä¸åŒ¹é…åºåˆ—çš„æœ€å³ä¸‹æ ‡å€¼ï¼Œå‡ºç°å·¦æ‹¬å·ï¼Œå°†å…¶ä¸‹æ ‡å‹å…¥æ ˆä¸­ï¼Œ
å‡ºç°å³æ‹¬å·æ—¶ï¼Œå‡è®¾å…¶ä¸‹æ ‡å€¼ä¸ºright
è‹¥æ ˆä¸ºç©ºï¼Œåˆ™è¯¥å³æ‹¬å·æ— æ³•åŒ¹é…ï¼Œä¸”å®ƒä¼šæŠŠä¹‹åçš„åŒ¹é…åºåˆ—å’Œå®ƒä¹‹å‰çš„åŒ¹é…åºåˆ—éš”å¼€ï¼Œæ›´æ–°lastï¼›
è‹¥æ ˆä¸ä¸ºç©ºï¼Œå¼¹å‡ºæ ˆé¡¶çš„å·¦æ‹¬å·ä¸‹æ ‡ï¼Œå¼¹å‡ºåè‹¥æ ˆä¸ºç©ºï¼Œç”¨right-lastæ›´æ–°æœ€é•¿é•¿åº¦ï¼Œå¦åˆ™ç”¨right-top_leftæ›´æ–°ï¼Œtop_leftä¸ºå¼¹å‡ºåæ ˆé¡¶çš„å€¼ï¼›
```java
public int longestValidParentheses(String s) {
        Stack<Integer> stack = new Stack<>();
        int result = 0;
        int last = -1;
        for(int i = 0, length = s.length(); i < length; ++i) {
            final Character ch = s.charAt(i);
            //left bracket, push into stack, wait for right bracket
            if(ch.equals('(')) {
                stack.push(i);
            } else {
                //empty, right bracket is useless, nothing to match
                //update last position
                //due to existence this right bracket, the sequence is separated
                if(stack.isEmpty()) {
                    last = i;
                } else {
                    //pop the top left bracket
                    stack.pop();
                    result = Math.max(result, stack.isEmpty() ? i - last : i - stack.peek());
                }
            }
        }
        return result;
    }
```
